% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ONDSA.R
\name{ONDSA}
\alias{ONDSA}
\title{ONDSA: Omics Network Differential and Similarity Analysis}
\usage{
ONDSA(Omega, p, K, N, alpha, varname)
}
\arguments{
\item{Omega}{A list of estimated precision matrices, each representing the omics network for a specific group}

\item{p}{An integer, the number of variables (nodes) in each network}

\item{K}{An integer, the number of groups (or networks)}

\item{N}{A numeric vector containing the sample sizes for each group}

\item{alpha}{A numeric value specifying the FDR control level for differential and similar structures at both steps}

\item{varname}{A character vector of names for the variables (nodes) in the networks}
}
\value{
A list containing two data frames, differential omics network structures and similar omics network structures:
\describe{
  \item{differential_structures}{A data frame of edges that differ significantly across the groups}
  \item{similar_structures}{A data frame of edges that are similar across the groups}
}
}
\description{
This function performs a two-step differential and similarity analysis on multiple omics networks based on GGMs.
It identifies both differential omics network structures (edges that differ across groups) and similar structures (edges that are similar across groups).
The procedure conducts rigorous statistical tests with FDR control at both steps.
ONDSA requires that each group is measured on the same set of variables, ensuring that the number of variables p remains the same across all groups
}
\details{
The ONDSA framework works in two main steps:
\itemize{
  \item Step 1: Identification of differential structures based on a Chi-square statistics with FDR control (based on the test statistics in T1matrix).
  \item Step 2: Identification of similar structures using a z-value with FDR control (based on the test statistics in T2matrix).
}
The function first computes test statistics for differential structures in the precision matrices using \code{Diff.Chisq.omega},
followed by FDR control with \code{FDR_control_t1}. In the second step, it identifies edges that are similar across groups using
\code{Diff.Z.omega} and applies FDR control with \code{FDR_control_t2}.
}
\examples{
# Load the raw data for the three groups
data(ThreeGroupRawOmicsData)

# Standardize the raw data for each group
Data_1Std <- apply(group1_rawdata, 2, standardize)
Data_2Std <- apply(group2_rawdata, 2, standardize)
Data_3Std <- apply(group3_rawdata, 2, standardize)

# Set parameters
alpha <- 0.05
p <- 500
K <- 3
N <- c(nrow(group1_rawdata), nrow(group2_rawdata), nrow(group3_rawdata))
varname <- colnames(group1_rawdata)

# Estimate group-specific precision matrices using FastGGM
n_total <- sum(N)
lambda_value <- sqrt(2 * log(p / sqrt(n_total)) / n_total)
fastggm_1 <- FastGGM_Parallel(Data_1Std, lambda=lambda_value)
fastggm_2 <- FastGGM_Parallel(Data_2Std, lambda=lambda_value)
fastggm_3 <- FastGGM_Parallel(Data_3Std, lambda=lambda_value)

# Create list of precision matrices
Omega <- list(fastggm_1$precision, fastggm_2$precision, fastggm_3$precision)

# Run ONDSA with the estimated precision matrices
result <- ONDSA(Omega, p, K, N, alpha, varname)
result$differential_structures
result$similar_structures

}
